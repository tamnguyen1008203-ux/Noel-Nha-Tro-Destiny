<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Merry Christmas - Nhà Trọ Destiny</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@500&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-red: #b32626;
            --vintage-cream: #f4eee1;
            --gold: #c5a059;
        }

        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #0b1a2a url('https://images.unsplash.com/photo-1543589077-47d81606c1bf?q=80&w=2070') no-repeat center center/cover;
            overflow: hidden;
            font-family: 'Quicksand', sans-serif;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.5) 100%);
            pointer-events: none;
            z-index: 2;
        }

        #fireworks { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 200; }

        /* --- PHONG BÌ --- */
        .envelope-container {
            position: relative;
            width: 320px; height: 210px;
            background-color: var(--vintage-cream);
            border-radius: 0 0 10px 10px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.6);
            cursor: pointer; z-index: 10;
        }

        .envelope-text {
            position: absolute; bottom: 15px; left: 50%;
            transform: translateX(-50%);
            color: var(--primary-red);
            font-family: 'Dancing Script', cursive;
            font-size: 2rem; width: 100%; text-align: center; z-index: 30;
        }

        .lid {
            position: absolute; top: 0; left: 0;
            border-left: 160px solid transparent; border-right: 160px solid transparent;
            border-top: 120px solid var(--primary-red);
            transform-origin: top; transition: transform 0.8s ease; z-index: 20;
        }

        .bow {
            position: absolute; top: 90px; left: 50%;
            transform: translateX(-50%);
            width: 60px; height: 60px;
            background: #d42426; border-radius: 50%;
            z-index: 40; display: flex; justify-content: center; align-items: center;
            color: white; font-size: 10px; font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3); border: 2px solid white;
        }

        /* --- TẤM THƯ --- */
        .letter {
            position: absolute; top: 40%; left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 90%; max-width: 350px;
            min-height: 380px;
            background: var(--vintage-cream); padding: 20px;
            box-sizing: border-box; border: 8px double var(--gold); 
            border-radius: 5px; z-index: 100; opacity: 0;
            transition: all 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-align: center;
        }

        .letter-title {
            font-family: 'Dancing Script', cursive;
            color: var(--primary-red); font-size: 1.8rem;
            margin-bottom: 10px; border-bottom: 2px solid var(--gold);
        }

        .typed-content { font-size: 0.9rem; line-height: 1.5; color: #3e2723; }

        #closing-text {
            font-family: 'Dancing Script'; font-size: 1.4rem;
            color: var(--primary-red); margin-top: 15px;
            opacity: 0; transition: opacity 1s ease-in;
        }

        /* --- ẢNH NHẢY VÀO (FIX TRÁNH CHE CHỮ) --- */
        .side-img-container {
            position: fixed;
            bottom: -500px;
            width: 130px; 
            transition: all 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            z-index: 150;
            text-align: center;
        }

        .side-img-container img {
            width: 100%;
            border-radius: 10px;
            border: 3px solid white;
            box-shadow: 0 8px 15px rgba(0,0,0,0.4);
        }

        .side-text {
            color: #ffffff;
            font-family: 'Dancing Script', cursive;
            font-size: 1.1rem;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px #ff0000;
            font-weight: bold;
        }

        #left-img { left: 5%; }
        #right-img { right: 5%; }

        /* --- HIỆU ỨNG KHI MỞ --- */
        .open-state .lid { transform: rotateX(180deg); z-index: 5; }
        .open-state .envelope-container { transform: translateY(600px); opacity: 0; pointer-events: none; }
        .open-state .letter { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        
        /* Đẩy ảnh xuống sát mép dưới để không che nội dung */
        .open-state #left-img { bottom: 20px; transform: rotate(-5deg); }
        .open-state #right-img { bottom: 20px; transform: rotate(5deg); }

        /* Responsive cho máy tính (giữ nguyên kích thước lớn) */
        @media (min-width: 1024px) {
            .side-img-container { width: 220px; }
            .side-text { font-size: 1.8rem; }
            .open-state #left-img { bottom: 50px; left: 10%; }
            .open-state #right-img { bottom: 50px; right: 10%; }
            .letter { max-width: 400px; min-height: 480px; top: 50%; }
            .typed-content { font-size: 1.1rem; }
        }

        .snow { position: fixed; top: -10px; background: white; border-radius: 50%; pointer-events: none; animation: fall linear infinite; z-index: 99; }
        @keyframes fall { to { transform: translateY(100vh); } }
    </style>
</head>
<body>

    <canvas id="fireworks"></canvas>

    <audio id="bgMusic" loop><source src="music.mp3" type="audio/mpeg"></audio>
    <audio id="clickSound"><source src="https://www.fesliyanstudios.com/play-mp3/387" type="audio/mpeg"></audio>

    <div class="side-img-container" id="left-img">
        <div class="side-text">Cung hỷ Christmas</div>
        <img src="merry1.png" alt="Merry 1">
    </div>
    <div class="side-img-container" id="right-img">
        <div class="side-text">, Merry phát tài</div>
        <img src="merry2.png" alt="Merry 2">
    </div>

    <div class="envelope-container" onclick="openLetter()">
        <div class="lid"></div>
        <div class="bow">OPEN</div>
        <div class="envelope-text">Nhà Trọ Destiny</div>
    </div>

    <div class="letter" id="letter">
        <div class="letter-title">Merry Christmas</div>
        <div id="typewriter" class="typed-content"></div>
        <p id="closing-text">Hihi, love you all!!</p>
    </div>

    <script>
        const message = "Lời đầu tiên, xin chúc cho nhà trọ Destiny chúng ta một mùa giáng sinh an lành. Chúc cho mọi người luôn luôn hạnh phúc, công việc sẽ ngày càng phát triển, thuận lợi hơn. Ai chưa có bồ thì sẽ có bồ ngay sau giáng sinh, ai có rồi thì sẽ yêu nhau thật lâu. Cuối cùng, chúc cho chúng ta sẽ có thể giữ được mối quan hệ thân thiết như bây giờ và về sau này (nếu được).";
        let i = 0;

        function openLetter() {
            if (!document.body.classList.contains('open-state')) {
                document.getElementById('clickSound').play().catch(() => {});
                document.body.classList.add('open-state');
                document.getElementById('bgMusic').play().catch(() => {});
                setTimeout(typeWriter, 1200);
            }
        }

        function typeWriter() {
            if (i < message.length) {
                document.getElementById("typewriter").innerHTML += message.charAt(i);
                i++;
                setTimeout(typeWriter, 40);
            } else {
                setTimeout(() => {
                    document.getElementById("closing-text").style.opacity = "1";
                    startFireworks();
                }, 500);
            }
        }

        const canvas = document.getElementById('fireworks');
        const ctx = canvas.getContext('2d');
        let particles = [];
        function startFireworks() {
            canvas.width = window.innerWidth; canvas.height = window.innerHeight;
            animateFireworks();
            setInterval(() => { createFirework(Math.random() * canvas.width, Math.random() * canvas.height * 0.5); }, 800);
        }
        function createFirework(x, y) {
            const colors = ['#ff0000', '#ffd700', '#ffffff', '#ff69b4', '#00ff00'];
            for (let i = 0; i < 40; i++) {
                particles.push({ x, y, dx: (Math.random()-0.5)*7, dy: (Math.random()-0.5)*7, size: Math.random()*2.5, color: colors[Math.floor(Math.random()*colors.length)], life: 100 });
            }
        }
        function animateFireworks() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach((p, idx) => {
                p.x += p.dx; p.y += p.dy; p.dy += 0.05; p.life -= 2;
                ctx.fillStyle = p.color; ctx.beginPath(); ctx.arc(p.x, p.y, p.size, 0, Math.PI*2); ctx.fill();
                if (p.life <= 0) particles.splice(idx, 1);
            });
            requestAnimationFrame(animateFireworks);
        }

        setInterval(() => {
            const snow = document.createElement('div'); snow.classList.add('snow');
            snow.style.left = Math.random() * 100 + 'vw';
            const s = Math.random()*4+2+'px'; snow.style.width = s; snow.style.height = s;
            snow.style.animationDuration = Math.random()*3+2+'s';
            document.body.appendChild(snow); setTimeout(() => snow.remove(), 5000);
        }, 150);
    </script>
</body>
</html>